# Hodge Parity Journal

Use one entry per parity hypothesis.

## Entry Template
- Timestamp:
- Commit:
- Hypothesis:
- Files touched:
- Commands:
- Numeric parity deltas:
- Decision: `kept` | `rejected` | `deferred`
- Notes:

## 2026-02-14 Baseline Harness + Gauge-Invariant Metrics
- Timestamp: 2026-02-14T16:09:21Z
- Commit: working tree (uncommitted)
- Hypothesis: Establish deterministic cross-language parity artifacts first, then compare harmonic forms in ambient space (not raw coefficient coordinates) to avoid basis-order artifacts.
- Files touched:
  - `include/igneous/data/topology.hpp`
  - `include/igneous/ops/geometry.hpp`
  - `include/igneous/ops/spectral.hpp`
  - `include/igneous/ops/hodge.hpp`
  - `src/main_hodge.cpp`
  - `src/main_diffusion.cpp`
  - `src/main_spectral.cpp`
  - `tests/test_topology_diffusion.cpp`
  - `tests/test_ops_spectral_geometry.cpp`
  - `tests/test_ops_hodge.cpp`
  - `benches/bench_dod.cpp`
  - `benches/bench_pipelines.cpp`
  - `scripts/hodge/setup_reference_env.sh`
  - `scripts/hodge/generate_input_torus.py`
  - `scripts/hodge/run_reference_hodge.py`
  - `scripts/hodge/run_cpp_hodge.sh`
  - `scripts/hodge/compare_hodge_outputs.py`
  - `scripts/hodge/run_parity_round.sh`
  - `notes/hodge/journal.md`
- Commands:
  - `cmake --build build -j8`
  - `ctest --test-dir build --output-on-failure`
  - `scripts/hodge/run_parity_round.sh`
  - `python3 scripts/hodge/compare_hodge_outputs.py --reference-dir notes/hodge/results/round_20260214-160921/reference --cpp-dir notes/hodge/results/round_20260214-160921/cpp --output-markdown notes/hodge/results/round_20260214-160921/report/parity_report.md --output-json notes/hodge/results/round_20260214-160921/report/parity_report.json --label \"Hodge parity round 20260214-160921\"`
- Numeric parity deltas:
  - Baseline report: `notes/hodge/results/round_20260214-160921/report/parity_report.json`
  - Composite score: `0.310740`
  - Harmonic subspace max principal angle: `9.229825 deg`
  - Harmonic Procrustes error: `0.129113`
  - Circular correlation min: `0.098627`
  - Circular wrapped P95 max: `2.936349 rad`
- Decision: `kept`
- Notes:
  - Concrete structural mismatch identified: coefficient-space harmonic comparison is not gauge-invariant due basis ordering differences.
  - Primary harmonic parity metrics now use `harmonic_ambient.csv` / `reference_harmonic_ambient.csv`.

## 2026-02-14 Hypothesis A1: Normalized Symmetric-Kernel Eigensolve
- Timestamp: 2026-02-14T16:11:23Z
- Commit: working tree (uncommitted)
- Hypothesis: Solving eigenvectors on `D^{-1/2} K D^{-1/2}` instead of `K` will improve harmonic-form parity.
- Files touched:
  - `include/igneous/ops/spectral.hpp` (reverted)
- Commands:
  - `cmake --build build -j8`
  - `PREVIOUS_REPORT_JSON=notes/hodge/results/round_20260214-160921/report/parity_report.json scripts/hodge/run_parity_round.sh`
  - `python3 scripts/hodge/compare_hodge_outputs.py --reference-dir notes/hodge/results/round_20260214-161123/reference --cpp-dir notes/hodge/results/round_20260214-161123/cpp --output-markdown notes/hodge/results/round_20260214-161123/report/parity_report.md --output-json notes/hodge/results/round_20260214-161123/report/parity_report.json --label \"Hodge parity round 20260214-161123\" --previous-json notes/hodge/results/round_20260214-160921/report/parity_report.json`
- Numeric parity deltas:
  - Report: `notes/hodge/results/round_20260214-161123/report/parity_report.json`
  - Composite: `0.249454` (`-19.72%` vs baseline)
  - Harmonic subspace max principal angle: `4.066515 deg` (improved)
  - Harmonic Procrustes error: `0.059640` (improved)
  - Circular correlation min: `0.050558` (regressed)
  - Circular wrapped P95 max: `2.964019 rad` (regressed)
- Decision: `rejected`
- Notes:
  - Improvement was below the required `20%` keep threshold.
  - Change discarded per commit gate policy.

## 2026-02-14 Hypothesis D1: Circular Mode Selection Parity
- Timestamp: 2026-02-14T16:18:50Z
- Commit: working tree (uncommitted)
- Hypothesis: The reference workflow uses the first positive-imaginary circular mode for each harmonic form; setting second mode default to `0` (not `1`) should restore circular parity.
- Files touched:
  - `src/main_hodge.cpp`
  - `scripts/hodge/run_reference_hodge.py`
  - `scripts/hodge/run_cpp_hodge.sh`
  - `scripts/hodge/run_parity_round.sh`
- Commands:
  - `cmake --build build -j8`
  - `PREVIOUS_REPORT_JSON=notes/hodge/results/round_20260214-160921/report/parity_report.json scripts/hodge/run_parity_round.sh`
- Numeric parity deltas:
  - Report: `notes/hodge/results/round_20260214-161850/report/parity_report.json`
  - Composite: `0.045839` (`-85.25%` vs baseline)
  - Harmonic subspace max principal angle: `4.155913 deg`
  - Harmonic Procrustes error: `0.060369`
  - Circular correlation min: `0.995021` (major improvement)
  - Circular wrapped P95 max: `0.170368 rad` (major improvement)
- Decision: `kept`
- Notes:
  - This is a structural parity fix in eigenmode selection policy, not a numerical micro-optimization.
  - Remaining gaps are now concentrated in harmonic-form thresholds and circular P95 tail.

## 2026-02-14 Hypothesis H1: Deterministic Reference Basis in Harness
- Timestamp: 2026-02-14T16:26:56Z
- Commit: `388e076` + working tree (uncommitted)
- Hypothesis: Reference parity runs are unstable because the reference eigensolver initialisation is random; precomputing a deterministic function basis from the same reference kernel path should stabilise comparisons.
- Files touched:
  - `scripts/hodge/run_reference_hodge.py`
- Commands:
  - `scripts/hodge/run_parity_round.sh` (repeated)
  - Determinism check:
    - repeated `scripts/hodge/run_reference_hodge.py` runs and checksum comparison on `reference_harmonic_coeffs.csv`
- Numeric parity deltas:
  - Deterministic baseline report: `notes/hodge/results/round_20260214-162656/report/parity_report.json`
  - Composite score: `0.156485`
  - Harmonic subspace max principal angle: `6.493845 deg`
  - Harmonic Procrustes error: `0.098484`
  - Circular correlation min: `0.714689`
  - Circular wrapped P95 max: `1.572800 rad`
- Decision: `kept`
- Notes:
  - Reference outputs are now repeatable across runs for identical inputs/parameters.
  - This intentionally re-baselines parity metrics for reliable hypothesis gating.

## 2026-02-14 Hypothesis A2: Normalized Symmetric-Kernel Eigensolve (Deterministic Baseline)
- Timestamp: 2026-02-14T16:28:53Z
- Commit: `388e076` + working tree (uncommitted)
- Hypothesis: Under deterministic reference outputs, solving the normalized symmetric operator `D^{-1/2} K D^{-1/2}` should materially reduce harmonic mismatch.
- Files touched:
  - `include/igneous/ops/spectral.hpp`
- Commands:
  - `cmake --build build -j8`
  - `PREVIOUS_REPORT_JSON=notes/hodge/results/round_20260214-162656/report/parity_report.json scripts/hodge/run_parity_round.sh`
  - Stability check: repeated `scripts/hodge/run_parity_round.sh` runs
- Numeric parity deltas:
  - Report: `notes/hodge/results/round_20260214-162853/report/parity_report.json`
  - Composite: `0.066904` (`-57.25%` vs deterministic baseline)
  - Harmonic subspace max principal angle: `6.376378 deg`
  - Harmonic Procrustes error: `0.097143`
  - Circular correlation min: `0.996571` (major improvement)
  - Circular wrapped P95 max: `0.163400 rad` (major improvement)
- Decision: `kept`
- Notes:
  - Cleared the 20% keep threshold with deterministic artifacts.
  - Harmonic thresholds remain the dominant blocker.

## 2026-02-14 Hypothesis H2: Double-Precision Hodge/Circular Solves
- Timestamp: 2026-02-14T16:30:47Z
- Commit: `388e076` + working tree (uncommitted)
- Hypothesis: Promoting Hodge spectral and circular generalized eigensolves to double precision will reduce harmonic/circular error tails.
- Files touched:
  - `include/igneous/ops/hodge.hpp` (reverted)
- Commands:
  - `cmake --build build -j8`
  - `PREVIOUS_REPORT_JSON=notes/hodge/results/round_20260214-162853/report/parity_report.json scripts/hodge/run_parity_round.sh`
- Numeric parity deltas:
  - Report: `notes/hodge/results/round_20260214-163047/report/parity_report.json`
  - Composite: `0.159232` (`+138.00%` regression)
  - Circular correlation min dropped to `0.714585`
  - Circular wrapped P95 max regressed to `1.566015 rad`
- Decision: `rejected`
- Notes:
  - Severe regression; reverted immediately.

## 2026-02-14 Hypothesis A3: Symmetric Eigenvector Ordering Parity
- Timestamp: 2026-02-14T16:57:05Z
- Commit: `3c07519` + working tree (uncommitted)
- Hypothesis: Reversing symmetric-eigensolver output columns after `LargestMagn` sorting is inconsistent with reference ordering and inflates parity error; removing the reversal should improve harmonic and circular alignment.
- Files touched:
  - `include/igneous/ops/spectral.hpp`
- Commands:
  - `cmake --build build -j8`
  - `scripts/hodge/run_parity_round.sh`
  - `scripts/hodge/run_parity_round.sh` (stability repeat)
- Numeric parity deltas:
  - Baseline report: `notes/hodge/results/round_20260214-162853/report/parity_report.json`
  - Report: `notes/hodge/results/round_20260214-165639/report/parity_report.json`
  - Stability report: `notes/hodge/results/round_20260214-165649/report/parity_report.json`
  - Composite: `0.042955` (`-35.80%` vs baseline)
  - Harmonic subspace max principal angle: `4.298653 deg` (improved from `6.376378 deg`)
  - Harmonic Procrustes error: `0.066736` (improved from `0.097143`)
  - Circular correlation min: `0.999483` (improved from `0.996571`)
  - Circular wrapped P95 max: `0.059370 rad` (improved from `0.163400 rad`)
- Decision: `kept`
- Notes:
  - Improvement is deterministic across repeated rounds with identical metrics.
  - Final gates are not yet fully met; remaining blocker is harmonic-form error above target thresholds.

## 2026-02-14 Hypothesis A4: Down-Laplacian Composition via Function Gram Inverse
- Timestamp: 2026-02-14T17:02:39Z
- Commit: `53d53c0` + working tree (uncommitted)
- Hypothesis: Replacing `L_down = D D^T` with `L_down = D G0^{+} D^T` (spectral pseudo-inverse of function Gram) should match reference operator composition and reduce harmonic mismatch.
- Files touched:
  - `include/igneous/ops/hodge.hpp`
  - `src/main_hodge.cpp`
  - `tests/test_ops_hodge.cpp`
  - `benches/bench_pipelines.cpp`
  - `benches/bench_dod.cpp`
- Commands:
  - `cmake --build build -j8`
  - `ctest --test-dir build --output-on-failure`
  - `PREVIOUS_REPORT_JSON=notes/hodge/results/round_20260214-165639/report/parity_report.json scripts/hodge/run_parity_round.sh`
- Numeric parity deltas:
  - Baseline report: `notes/hodge/results/round_20260214-165639/report/parity_report.json`
  - Report: `notes/hodge/results/round_20260214-170227/report/parity_report.json`
  - Composite: `0.135324` (`+215.03%` regression)
  - Harmonic subspace max principal angle: `4.298795 deg` (no meaningful change)
  - Harmonic Procrustes error: `0.066738` (no meaningful change)
  - Circular correlation min: `0.711944` (major regression)
  - Circular wrapped P95 max: `1.541583 rad` (major regression)
- Decision: `rejected`
- Notes:
  - Change severely degraded circular parity while not improving harmonic parity.
  - Patch discarded and reverted.

## 2026-02-14 Hypothesis A5: Full-NCV Symmetric Eigensolve
- Timestamp: 2026-02-14T17:06:35Z
- Commit: `53d53c0` + working tree (uncommitted)
- Hypothesis: Disabling the compact symmetric eigensolver path (`ncv = k + 16`) and always using full `ncv` parity settings should reduce harmonic mismatch.
- Files touched:
  - `include/igneous/ops/spectral.hpp` (reverted)
- Commands:
  - `cmake --build build -j8`
  - `ctest --test-dir build --output-on-failure`
  - `PREVIOUS_REPORT_JSON=notes/hodge/results/round_20260214-165639/report/parity_report.json scripts/hodge/run_parity_round.sh`
  - Circular mode sweep over `(mode_0, mode_1) in [0..4]x[0..4]` using `scripts/hodge/run_cpp_hodge.sh` + `scripts/hodge/compare_hodge_outputs.py`
- Numeric parity deltas:
  - Baseline report: `notes/hodge/results/round_20260214-165639/report/parity_report.json`
  - Report: `notes/hodge/results/round_20260214-170501/report/parity_report.json`
  - Composite: `0.135310` (`+215.00%` regression)
  - Harmonic subspace max principal angle: `4.297332 deg` (minor change)
  - Harmonic Procrustes error: `0.066720` (minor change)
  - Circular correlation min: `0.711942` (major regression)
  - Circular wrapped P95 max: `1.541530 rad` (major regression)
  - Best mode pair after sweep remained `(0,0)`; no mode remapping recovered baseline parity.
- Decision: `rejected`
- Notes:
  - Regression is intrinsic to the full-`ncv` patch under this pipeline and not a mode-index artifact.
  - Patch discarded and reverted.
